# :pushpin: 시계열 예측 모델을 이용한 intel 주식 종가 예측
>시계열 예측 모델을 이용하여 intel의 주식 종가를 예측(미니 프로젝트)

</br>

## 1. 제작 기간 & 참여 인원 및 역할
- 2022년 3월 28일 ~ 4월 1일
- 한양대학교 산학협력단(K-digital training)/미니 프로젝트
- 총 인원 5인
- 역할: 팀원

#### `활동내역`
- 프로젝트 운영 및 관리 지원
- 시계열 머신러닝 알고리즘 조사 및 모델제작
- 머신러닝 학습 환경 구축
- BiLSTM, GRU 알고리즘 논문 조사 및 모델제작
- Tensorflow, CUDA/cuDNN 환경 구축


</br>

## 2. 사용 기술
#### `시스템`
  - Windows 10 SP2
  - CUDA 11.3
  - cuDNN 8.2.1
  - Anaconda
#### `예측 모델`
  - Python 3.8.10
  - Tensorflow 2.8.0
  - Pandas 1.4.0
  - Keras
  - Numpy


</br>

## 3. 모델 별 결과치
### 3.1. 13개 변수/window size: 50/Patience: 15/Epoch: 200
![](https://user-images.githubusercontent.com/81274469/175939431-d1e19dd6-bede-49b4-bbd8-d173c9fab85a.png)
### 3.2. 17개 변수/window size: 50/Patience: 15/Epoch: 200
![](https://user-images.githubusercontent.com/81274469/175939438-61992f5d-2a4e-4a7f-bdbb-e7d5cd317862.png)


## 4. 핵심 기능
CNN 1차원 레이어를 통해 분석 데이터를 3차원화 한 후 양방향 LSTM을 이용하여 시계열 예측 진행함.

- Yahoo finance api를 이용하여 주가지수/원자재/국채 금리/경쟁사 주가 등의 데이터를 수집함.
- 2017년 1월 1일 부터 2020년 12월 31일 까지를 Train Set으로, 2021년 1월 1일부터 2021년 12월 31일 까지를 Test Set으로 설정하였음.

![최종 선정 결과]()

![BILSTM](https://user-images.githubusercontent.com/81274469/175943150-121a64cf-ea78-4a29-9b59-b80d5e3819c3.png)
https://user-images.githubusercontent.com/81274469/175884412-f231bad0-f74d-494f-a7f2-6dda22f46b03.jpg)

### 4.1. 양방향 LSTM 선정 배경
1. LSTM은 이전의 데이터를 반영하여 예측하는데 단방향의 경우 일정한 패턴을 보이는 주식의 특성상 이전값을 따라가는 양상이 짙음.
2. 주식은 그 특성상 급격하게 변하는 순간이 오기 마련인데, 이 경우 예측률이 크게 떨어짐.
3. 양방향 LSTM은 LSTM의 특성으로 인해 이전값을 따라가는 양상을 개선하고자 정방향과 역방향을 동시에 반영하여 예측함.
4. 본 프로젝트 에서는 양방향 LSTM에 주가와 별도로 주가와 관련있는 다른 요소들을 반영하여 이를 교정하고자 함.

### 4.2. 변수 선정 과정
- **각 변수를 예측값으로 설정하여 모델 통과**
![.](https://user-images.githubusercontent.com/81274469/175943141-ad591fa3-127a-4c98-adfa-57e6d28c8dbc.png)
  - 임의로 선정한 16개의 변수들을 각각 예측값으로 설정하여 intel 주가와의 관계를 파악함.
  - 과적합을 피하기 위하여 상관관계가 높은것과 낮은것을 배합하였음.
  - 이를 통해 10개의 변수를 기본값으로 설정하고 훈련 결과에 따라 다른 변수들을 반영 하였음.

### 4.3. 전체 훈련 결과
- **모델별로 다양한 경우의 변수 조합 설정**
![.](https://user-images.githubusercontent.com/81274469/175943147-93f8a96a-8c47-49dd-b2f5-5b86a54710c8.png)
  - 50여개의 결과 값 중 가장 성능이 우수한 2개의 모델을 도출함.
  - 변수 13개의 경우, RMSE와 MAE가 높으나 이전의 가격을 따라가는 양상을 보임.
  - 변수 17개의 경우 13개 모델보다는 RMSE와 MAE가 낮으나, 

### 4.4. 결론
- **시계열 예측의 한계**
- LSTM은 효율적인 시계열 예측 모델로서 학습효율과 성능이 우수하여 랩탑 GPU 만으로도 일정 수준의 예측 모델 제작이 가능 하였음.
- 주식은 일정한 패턴과 블랙스완 효과에 따른 급격한 변화가 공존하는 데이터임.
- LSTM은 급격한 변화를 감지하는데에 있어서 매우 취약한 모습을 보여줌.
- 
</div>
</details>
